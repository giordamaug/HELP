
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Install HELP from GitHub &#8212; HELP 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial1/prediction';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Install HELP from GitHub" href="experiment.html" />
    <link rel="prev" title="Install HELP from GitHub" href="csegs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/HELP_logo.png" class="logo__image only-light" alt="HELP 1.0 documentation - Home"/>
    <script>document.write(`<img src="../_static/HELP_logo.png" class="logo__image only-dark" alt="HELP 1.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../help.html">
                        help package
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorial1.html">
                        EG detection for a tissue
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../help.html">
                        help package
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorial1.html">
                        EG detection for a tissue
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="labelling.html">Install HELP from GitHub</a></li>





</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="embedding.html">Install HELP from GitHub (and Karateclub)</a></li>



</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="csegs.html">Install HELP from GitHub</a></li>





</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Install HELP from GitHub</a></li>




</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="experiment.html">Install HELP from GitHub</a></li>




</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorial1.html" class="nav-link">EG detection for a tissue</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Install...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <a class="reference external image-reference" href="https://colab.research.google.com/github/giordamaug/HELP/blob/main/help/notebooks/prediction.ipynb"><img alt="https://colab.research.google.com/assets/colab-badge.svg" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external image-reference" href="https://www.kaggle.com/notebooks/welcome?src=https://github.com/giordamaug/HELP/blob/main/help/notebooks/prediction.ipynb"><img alt="https://kaggle.com/static/images/open-in-kaggle.svg" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a>
<section id="install-help-from-github">
<h1>Install HELP from GitHub<a class="headerlink" href="#install-help-from-github" title="Link to this heading">#</a></h1>
<p>Skip this cell if you already have installed HELP.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/giordamaug/HELP.git
</pre></div>
</div>
</section>
<section id="download-the-input-files">
<h1>Download the input files<a class="headerlink" href="#download-the-input-files" title="Link to this heading">#</a></h1>
<p>In this cell we download from GitHub repository the label file and the
attribute files. Skip this step if you already have these input files
locally.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span>https://raw.githubusercontent.com/giordamaug/HELP/main/help/datafinal/Kidney_HELP.csv
<span class="o">!</span>wget<span class="w"> </span>https://raw.githubusercontent.com/giordamaug/HELP/main/help/datafinal/Kidney_BIO.csv
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="o">!</span>wget<span class="w"> </span>https://raw.githubusercontent.com/giordamaug/HELP/main/help/datafinal/Kidney_CCcfs_<span class="o">{</span>i<span class="o">}</span>.csv
<span class="o">!</span>wget<span class="w"> </span>https://raw.githubusercontent.com/giordamaug/HELP/main/help/datafinal/Kidney_EmbN2V_128.csv
</pre></div>
</div>
</section>
<section id="process-the-tissue-attributes">
<h1>Process the tissue attributes<a class="headerlink" href="#process-the-tissue-attributes" title="Link to this heading">#</a></h1>
<p>In this code we load tissue gene attributes by several datafiles. We
apply missing values fixing and data scaling with
<code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.StandardScaler</span></code> on the <code class="docutils literal notranslate"><span class="pre">BIO</span></code> and <code class="docutils literal notranslate"><span class="pre">CCcfs</span></code>
attributes, while no normalization and fixing on embedding attributes
(<code class="docutils literal notranslate"><span class="pre">EmbN2V_128</span></code>). The attributes are all merged in one matrix by the
<code class="docutils literal notranslate"><span class="pre">feature_assemble</span></code> function as input for the prediction model
building.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span><span class="o">=</span><span class="s1">&#39;Kidney&#39;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">help.preprocess.loaders</span> <span class="kn">import</span> <span class="n">feature_assemble_df</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tissue</span><span class="si">}</span><span class="s2">_HELP.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;aE&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;sNE&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_y</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;fname&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tissue</span><span class="si">}</span><span class="s1">_BIO.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;fixna&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="s1">&#39;std&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;fname&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tissue</span><span class="si">}</span><span class="s1">_CCcfs.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;fixna&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;nchunks&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;fname&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tissue</span><span class="si">}</span><span class="s1">_EmbN2V_128.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;fixna&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;normalize&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}]</span>
<span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span> <span class="o">=</span> <span class="n">feature_assemble_df</span><span class="p">(</span><span class="n">df_y</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saveflag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">label</span>
<span class="n">NE</span>       <span class="mi">16678</span>
<span class="n">E</span>         <span class="mi">1253</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
<span class="n">Majority</span> <span class="n">NE</span> <span class="mi">16678</span> <span class="n">minoriy</span> <span class="n">E</span> <span class="mi">1253</span>
<span class="p">[</span><span class="n">Kidney_BIO</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">52532</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_BIO</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">Normalization</span> <span class="k">with</span> <span class="n">std</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Loading file in chunks: 100%|██████████| 5/5 [00:11&lt;00:00,  2.36s/it]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Kidney_CCcfs</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">6676644</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_CCcfs</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">Normalization</span> <span class="k">with</span> <span class="n">std</span> <span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_EmbN2V_128</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">0</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_EmbN2V_128</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">No</span> <span class="n">normalization</span><span class="o">...</span>
<span class="mi">17236</span> <span class="n">labeled</span> <span class="n">genes</span> <span class="n">over</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">17931</span>
<span class="p">(</span><span class="mi">17236</span><span class="p">,</span> <span class="mi">3456</span><span class="p">)</span> <span class="n">data</span> <span class="nb">input</span>
</pre></div>
</div>
  <div id="df-0b535a8d-339f-4c4c-b065-ec50eb63c78d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gene length</th>
      <th>Transcripts count</th>
      <th>GC content</th>
      <th>GTEX_kidney</th>
      <th>Gene-Disease association</th>
      <th>OncoDB_expression</th>
      <th>HPA_kidney</th>
      <th>GO-MF</th>
      <th>GO-BP</th>
      <th>GO-CC</th>
      <th>...</th>
      <th>Node2Vec_119</th>
      <th>Node2Vec_120</th>
      <th>Node2Vec_121</th>
      <th>Node2Vec_122</th>
      <th>Node2Vec_123</th>
      <th>Node2Vec_124</th>
      <th>Node2Vec_125</th>
      <th>Node2Vec_126</th>
      <th>Node2Vec_127</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A1BG</th>
      <td>0.003351</td>
      <td>0.020942</td>
      <td>0.501832</td>
      <td>2.044542e-05</td>
      <td>0.002950</td>
      <td>NaN</td>
      <td>0.000002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.115385</td>
      <td>...</td>
      <td>0.120922</td>
      <td>-0.352630</td>
      <td>0.580697</td>
      <td>-0.659300</td>
      <td>-1.320486</td>
      <td>1.019308</td>
      <td>-0.469064</td>
      <td>0.123211</td>
      <td>0.557266</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>A1CF</th>
      <td>0.034865</td>
      <td>0.047120</td>
      <td>0.160530</td>
      <td>1.980884e-05</td>
      <td>NaN</td>
      <td>0.556939</td>
      <td>0.000232</td>
      <td>0.069767</td>
      <td>0.041026</td>
      <td>0.096154</td>
      <td>...</td>
      <td>-1.162494</td>
      <td>0.155702</td>
      <td>-1.162071</td>
      <td>0.534082</td>
      <td>0.798872</td>
      <td>0.149595</td>
      <td>-0.360515</td>
      <td>-1.060540</td>
      <td>-0.408493</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>A2M</th>
      <td>0.019624</td>
      <td>0.062827</td>
      <td>0.176932</td>
      <td>3.377232e-03</td>
      <td>0.073746</td>
      <td>0.584540</td>
      <td>0.005382</td>
      <td>0.302326</td>
      <td>0.056410</td>
      <td>0.076923</td>
      <td>...</td>
      <td>0.150766</td>
      <td>1.492019</td>
      <td>0.209449</td>
      <td>-1.034729</td>
      <td>-0.064318</td>
      <td>0.029690</td>
      <td>0.138344</td>
      <td>0.806095</td>
      <td>-0.496128</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>A2ML1</th>
      <td>0.026017</td>
      <td>0.041885</td>
      <td>0.299948</td>
      <td>5.123403e-07</td>
      <td>0.017699</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.069767</td>
      <td>0.005128</td>
      <td>0.038462</td>
      <td>...</td>
      <td>0.191344</td>
      <td>-0.542462</td>
      <td>0.746510</td>
      <td>0.082089</td>
      <td>-1.109212</td>
      <td>0.406936</td>
      <td>-1.332319</td>
      <td>-0.363864</td>
      <td>0.443284</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>A3GALT2</th>
      <td>0.005784</td>
      <td>0.000000</td>
      <td>0.473739</td>
      <td>1.421472e-06</td>
      <td>NaN</td>
      <td>0.663540</td>
      <td>0.000000</td>
      <td>0.069767</td>
      <td>0.015385</td>
      <td>0.057692</td>
      <td>...</td>
      <td>0.483003</td>
      <td>-0.197605</td>
      <td>0.164332</td>
      <td>0.040729</td>
      <td>-0.552362</td>
      <td>0.242761</td>
      <td>0.223486</td>
      <td>0.017539</td>
      <td>-0.526580</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ZYG11A</th>
      <td>0.021209</td>
      <td>0.010471</td>
      <td>0.288257</td>
      <td>7.073108e-06</td>
      <td>NaN</td>
      <td>0.634761</td>
      <td>0.000055</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>...</td>
      <td>-0.717935</td>
      <td>-0.072597</td>
      <td>0.585837</td>
      <td>0.172081</td>
      <td>-0.278010</td>
      <td>0.170799</td>
      <td>0.267462</td>
      <td>-0.211294</td>
      <td>-0.940943</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>ZYG11B</th>
      <td>0.040775</td>
      <td>0.005236</td>
      <td>0.248648</td>
      <td>7.271294e-05</td>
      <td>NaN</td>
      <td>0.646090</td>
      <td>0.000238</td>
      <td>0.000000</td>
      <td>0.005128</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.372134</td>
      <td>0.007040</td>
      <td>-0.278071</td>
      <td>-1.309595</td>
      <td>-0.352476</td>
      <td>0.732887</td>
      <td>0.156505</td>
      <td>0.516706</td>
      <td>-0.412953</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>ZYX</th>
      <td>0.003958</td>
      <td>0.047120</td>
      <td>0.539522</td>
      <td>8.282866e-04</td>
      <td>NaN</td>
      <td>0.672638</td>
      <td>0.000177</td>
      <td>0.046512</td>
      <td>0.035897</td>
      <td>0.153846</td>
      <td>...</td>
      <td>-0.316321</td>
      <td>-0.382132</td>
      <td>0.400354</td>
      <td>0.322564</td>
      <td>0.400369</td>
      <td>0.188850</td>
      <td>0.593201</td>
      <td>-0.093008</td>
      <td>-0.508902</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>ZZEF1</th>
      <td>0.056017</td>
      <td>0.052356</td>
      <td>0.304484</td>
      <td>9.626291e-05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000121</td>
      <td>0.093023</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.520060</td>
      <td>-0.000595</td>
      <td>-0.101278</td>
      <td>-0.468345</td>
      <td>0.240905</td>
      <td>-0.124018</td>
      <td>0.568793</td>
      <td>-0.422793</td>
      <td>-0.701705</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>ZZZ3</th>
      <td>0.048909</td>
      <td>0.052356</td>
      <td>0.176758</td>
      <td>7.179946e-05</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000267</td>
      <td>0.093023</td>
      <td>0.051282</td>
      <td>0.057692</td>
      <td>...</td>
      <td>-0.348640</td>
      <td>-0.423926</td>
      <td>-0.078769</td>
      <td>0.163239</td>
      <td>-0.302664</td>
      <td>0.505735</td>
      <td>0.001912</td>
      <td>0.406448</td>
      <td>-0.296505</td>
      <td>NE</td>
    </tr>
  </tbody>
</table>
<p>17236 rows × 3457 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0b535a8d-339f-4c4c-b065-ec50eb63c78d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0b535a8d-339f-4c4c-b065-ec50eb63c78d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0b535a8d-339f-4c4c-b065-ec50eb63c78d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6d5afd22-23fe-4635-aa07-00c368aad7b5">
  <button class="colab-df-quickchart" onclick="quickchart('df-6d5afd22-23fe-4635-aa07-00c368aad7b5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6d5afd22-23fe-4635-aa07-00c368aad7b5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div></section>
<section id="prediction">
<h1>Prediction<a class="headerlink" href="#prediction" title="Link to this heading">#</a></h1>
<p>We process k-fold cross validation of a LightGBM classifier
(<code class="docutils literal notranslate"><span class="pre">n_splits=5</span></code>), and then we store predictions and print metrics.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">help.models.prediction</span> <span class="kn">import</span> <span class="n">predict_cv</span>
<span class="n">df_scores_means</span><span class="p">,</span> <span class="n">df_scores</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">predict_cv</span><span class="p">(</span><span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">balanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveflag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;pred_Kidney.csv&#39;</span><span class="p">)</span>
<span class="n">df_scores_means</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NE&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">label</span>
<span class="n">NE</span>       <span class="mi">15994</span>
<span class="n">E</span>         <span class="mi">1242</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
<span class="n">Classification</span> <span class="k">with</span> <span class="n">LightGBM</span><span class="o">...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>5-fold: 100%|██████████| 5/5 [05:10&lt;00:00, 62.04s/it]
</pre></div>
</div>
  <div id="df-aa4faf8e-009f-4118-be5b-fe810ec4e4d8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>measure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ROC-AUC</th>
      <td>0.9551±0.0063</td>
    </tr>
    <tr>
      <th>Accuracy</th>
      <td>0.9470±0.0033</td>
    </tr>
    <tr>
      <th>BA</th>
      <td>0.8326±0.0126</td>
    </tr>
    <tr>
      <th>Sensitivity</th>
      <td>0.6989±0.0244</td>
    </tr>
    <tr>
      <th>Specificity</th>
      <td>0.9663±0.0025</td>
    </tr>
    <tr>
      <th>MCC</th>
      <td>0.6283±0.0220</td>
    </tr>
    <tr>
      <th>CM</th>
      <td>[[868, 374], [539, 15455]]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-aa4faf8e-009f-4118-be5b-fe810ec4e4d8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-aa4faf8e-009f-4118-be5b-fe810ec4e4d8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-aa4faf8e-009f-4118-be5b-fe810ec4e4d8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-45d61ca5-7781-4b46-8b20-adf580c0ee8f">
  <button class="colab-df-quickchart" onclick="quickchart('df-45d61ca5-7781-4b46-8b20-adf580c0ee8f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-45d61ca5-7781-4b46-8b20-adf580c0ee8f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div><img alt="../_images/output_8_3.png" src="../_images/output_8_3.png" />
</section>
<section id="prediction-with-undersampling">
<h1>Prediction with undersampling<a class="headerlink" href="#prediction-with-undersampling" title="Link to this heading">#</a></h1>
<p>Due to the strong unbalancing between the two classes, we can redo
prediction model building by undersampling the majority class: this is
done by re-applying the <code class="docutils literal notranslate"><span class="pre">feature_assemble</span></code> function with parameter
<code class="docutils literal notranslate"><span class="pre">subsample=True</span></code>: this flag set causes the majority class to be
downsampled to 4 times the dimension of the minority class. The we
re-apply the k-fold cross validation of the a LightGBM classifier.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tissue</span><span class="si">}</span><span class="s2">_HELP.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;aE&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;sNE&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">})</span>
<span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span> <span class="o">=</span> <span class="n">feature_assemble_df</span><span class="p">(</span><span class="n">df_y</span><span class="p">,</span><span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_scores_means</span><span class="p">,</span> <span class="n">df_scores</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">predict_cv</span><span class="p">(</span><span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">balanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveflag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;pred_Kidney_sub.csv&#39;</span><span class="p">)</span>
<span class="n">df_scores_means</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Majority</span> <span class="n">NE</span> <span class="mi">16678</span> <span class="n">minoriy</span> <span class="n">E</span> <span class="mi">1253</span>
<span class="n">Subsampling</span> <span class="k">with</span> <span class="n">factor</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span>
<span class="p">[</span><span class="n">Kidney_BIO</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">52532</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_BIO</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">Normalization</span> <span class="k">with</span> <span class="n">std</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Loading file in chunks: 100%|██████████| 5/5 [00:14&lt;00:00,  3.00s/it]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Kidney_CCcfs</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">6676644</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_CCcfs</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">Normalization</span> <span class="k">with</span> <span class="n">std</span> <span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_EmbN2V_128</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">found</span> <span class="mi">0</span> <span class="n">Nan</span><span class="o">...</span>
<span class="p">[</span><span class="n">Kidney_EmbN2V_128</span><span class="o">.</span><span class="n">csv</span><span class="p">]</span> <span class="n">No</span> <span class="n">normalization</span><span class="o">...</span>
<span class="mi">6043</span> <span class="n">labeled</span> <span class="n">genes</span> <span class="n">over</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">6265</span>
<span class="p">(</span><span class="mi">6043</span><span class="p">,</span> <span class="mi">3456</span><span class="p">)</span> <span class="n">data</span> <span class="nb">input</span>
<span class="p">{</span><span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NE&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">label</span>
<span class="n">NE</span>       <span class="mi">4801</span>
<span class="n">E</span>        <span class="mi">1242</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
<span class="n">Classification</span> <span class="k">with</span> <span class="n">LightGBM</span><span class="o">...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>5-fold: 100%|██████████| 5/5 [02:32&lt;00:00, 30.57s/it]
</pre></div>
</div>
  <div id="df-73f2ea45-2c02-4bb3-a811-34fe14b10973" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>measure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ROC-AUC</th>
      <td>0.9538±0.0052</td>
    </tr>
    <tr>
      <th>Accuracy</th>
      <td>0.9125±0.0071</td>
    </tr>
    <tr>
      <th>BA</th>
      <td>0.8703±0.0163</td>
    </tr>
    <tr>
      <th>Sensitivity</th>
      <td>0.7987±0.0331</td>
    </tr>
    <tr>
      <th>Specificity</th>
      <td>0.9419±0.0046</td>
    </tr>
    <tr>
      <th>MCC</th>
      <td>0.7343±0.0244</td>
    </tr>
    <tr>
      <th>CM</th>
      <td>[[992, 250], [279, 4522]]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-73f2ea45-2c02-4bb3-a811-34fe14b10973')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-73f2ea45-2c02-4bb3-a811-34fe14b10973 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-73f2ea45-2c02-4bb3-a811-34fe14b10973');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-081f5979-6f4e-4934-a27f-9dc4293791e6">
  <button class="colab-df-quickchart" onclick="quickchart('df-081f5979-6f4e-4934-a27f-9dc4293791e6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-081f5979-6f4e-4934-a27f-9dc4293791e6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div><img alt="../_images/output_10_5.png" src="../_images/output_10_5.png" />
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="csegs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Install HELP from GitHub</p>
      </div>
    </a>
    <a class="right-next"
       href="experiment.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Install HELP from GitHub</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Install HELP from GitHub</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-input-files">Download the input files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#process-the-tissue-attributes">Process the tissue attributes</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction">Prediction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-with-undersampling">Prediction with undersampling</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorial1/prediction.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, National Research Council of Italy.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>